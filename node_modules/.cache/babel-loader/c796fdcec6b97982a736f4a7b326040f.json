{"ast":null,"code":"import _classCallCheck from\"/Users/zhangzirao/Desktop/website/Archive/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/zhangzirao/Desktop/website/Archive/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/zhangzirao/Desktop/website/Archive/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/zhangzirao/Desktop/website/Archive/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/zhangzirao/Desktop/website/Archive/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';// import Dimensions from 'react-dimensions';\nimport Img from'./Img';import CarouselPage from'./Carousel';import{Card,CardColumns,CardDeck,Col,Row}from'react-bootstrap';import Gallery from\"react-photo-gallery\";// import Carousel, { Modal, ModalGateway } from 'react-images';\nvar Album=/*#__PURE__*/function(_Component){_inherits(Album,_Component);var _super=_createSuper(Album);function Album(props){var _this;_classCallCheck(this,Album);_this=_super.call(this,props);_this.state={data:null,id:null,type:null,generalwidth:null,index:0,open:false};_this.myInput=React.createRef();_this.handleClick=_this.handleClick.bind(_assertThisInitialized(_this));_this.closeLightbox=_this.closeLightbox.bind(_assertThisInitialized(_this));_this.openLightbox=_this.openLightbox.bind(_assertThisInitialized(_this));return _this;}_createClass(Album,[{key:\"getdata\",value:function getdata(){var mycomp=this;fetch('/data/data.json').then(function(response){return response.json();}).then(function(responseData){console.log(responseData);console.log(mycomp.state.type);mycomp.setState({data:responseData[mycomp.state.type]});}).catch(function(error){console.log(error);});}},{key:\"componentWillReceiveProps\",value:function componentWillReceiveProps(nextProps){if(this.props.type!==nextProps.type){var _id=nextProps.match.params.id;// console.log(this.props.type,nextProps.type,_id)\nthis.setState({id:_id,type:nextProps.type});this.getdata();this.setState({generalwidth:this.myInput.current.offsetWidth});}}},{key:\"componentDidMount\",value:function componentDidMount(){var _id=this.props.match.params.id;this.setState({id:_id,type:this.props.type});this.getdata();this.setState({generalwidth:this.myInput.current.offsetWidth});}},{key:\"handleClick\",value:function handleClick(_index){console.log(\"test\",_index);this.setState({index:_index,open:true});}},{key:\"openLightbox\",value:function openLightbox(event,_ref){var photo=_ref.photo,index=_ref.index;// console.log(event, photo, index)\nthis.setState({index:index,open:true});}},{key:\"closeLightbox\",value:function closeLightbox(){this.setState({index:0,open:false});}},{key:\"render\",value:function render(){var _this2=this;var items,i,sf,namefont;items=[];sf={\"name\":\"Unknown\",\"column\":0};// console.log(this.state.data)\nif(this.state.data!==null){for(i=0;i<this.state.data.content.length;i++){// console.log(this.state.data.content[i].id,parseInt(this.state.id,10))\nif(this.state.data.content[i].id===parseInt(this.state.id,10)){sf=this.state.data.content[i];namefont=sf.font.name;var columnnum=sf.column;if(columnnum===0){columnnum=1;}var j;var lines=sf.lines;var photos={};for(j=1;j<=sf.pics.length;j++){photos[j]=sf.pics[j-1];}for(j=0;j<lines.length;j++){//calculate for each line\n// console.log(\"line\",j)\nvar totalwidth=0;var l;var index;var actualhight;for(l=0;l<lines[j].length;l++){index=lines[j][l];totalwidth+=100*photos[index].ratio;}if(this.state.generalwidth===null){actualhight=100;}else{actualhight=(this.state.generalwidth-100)*100/totalwidth;}// console.log(\"total width:\",totalwidth,\"generalwidth\",this.state.generalwidth,\"actualheight\",actualhight)\nfor(l=0;l<lines[j].length;l++){index=lines[j][l];// console.log(\"photo\",index,\"width\",photos[index].ratio * actualhight,\"height\",actualhight)\nitems.push({'index':index-1,'src':photos[index].src,'width':photos[index].ratio*actualhight,'height':actualhight});}}break;}}}else{namefont=\"\";}return/*#__PURE__*/React.createElement(Row,{style:{minHeight:\"80vh\",justifyContent:\"center\",alignItems:\"center\"}},/*#__PURE__*/React.createElement(Col,{ref:this.myInput,style:{backgroundColor:\"transparent\",marginTop:\"1vh\",borderColor:\"black\",justifyContent:\"center\",alignItems:\"center\"},xs:10},this.state.open?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(CarouselPage,{index:this.state.index,interval:null,data:sf}),/*#__PURE__*/React.createElement(\"button\",{onClick:this.closeLightbox},\"back\")):/*#__PURE__*/React.createElement(CardDeck,{style:{justifyContent:\"center\",alignItems:\"center\"}},items.map(function(item){return/*#__PURE__*/React.createElement(Img,{key:item.index,onClick:_this2.handleClick,index:item.index,src:item.src,style:{backgroundColor:\"transparent\",borderColor:\"transparent\",padding:\"2px 2px 2px 2px\",width:item.width,height:item.height}});}))));}}]);return Album;}(Component);;export default Album;","map":{"version":3,"sources":["/Users/zhangzirao/Desktop/website/Archive/src/component/Album.js"],"names":["React","Component","Img","CarouselPage","Card","CardColumns","CardDeck","Col","Row","Gallery","Album","props","state","data","id","type","generalwidth","index","open","myInput","createRef","handleClick","bind","closeLightbox","openLightbox","mycomp","fetch","then","response","json","responseData","console","log","setState","catch","error","nextProps","_id","match","params","getdata","current","offsetWidth","_index","event","photo","items","i","sf","namefont","content","length","parseInt","font","name","columnnum","column","j","lines","photos","pics","totalwidth","l","actualhight","ratio","push","src","minHeight","justifyContent","alignItems","backgroundColor","marginTop","borderColor","map","item","padding","width","height"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n// import Dimensions from 'react-dimensions';\nimport Img from './Img'\nimport CarouselPage from './Carousel'\nimport {Card, CardColumns, CardDeck, Col, Row} from 'react-bootstrap';\nimport Gallery from \"react-photo-gallery\";\n\n// import Carousel, { Modal, ModalGateway } from 'react-images';\n\nclass Album extends Component {\n    constructor(props){\n        super(props);\n\n        this.state={\n            data:null,\n            id:null,\n            type:null,\n            generalwidth:null,\n            index:0,\n            open:false,\n        }\n\n        this.myInput=React.createRef()\n        this.handleClick=this.handleClick.bind(this)\n        this.closeLightbox=this.closeLightbox.bind(this)\n        this.openLightbox = this.openLightbox.bind(this)\n    }\n\n    getdata(){\n        let mycomp = this;\n        fetch('/data/data.json').then(\n            function(response){\n                return response.json()\n            }\n        ).then(\n            function(responseData){\n                console.log(responseData)\n                console.log(mycomp.state.type)\n                mycomp.setState({data:responseData[mycomp.state.type]})\n            }\n        ).catch(\n            function(error){\n                console.log(error)\n            }\n        )\n    }\n\n    componentWillReceiveProps(nextProps){\n        if(this.props.type !== nextProps.type){\n            var _id = nextProps.match.params.id\n            // console.log(this.props.type,nextProps.type,_id)\n            this.setState({id:_id, type:nextProps.type})\n            this.getdata()\n            this.setState({generalwidth:this.myInput.current.offsetWidth})\n        }\n    }\n\n    componentDidMount(){\n        var _id = this.props.match.params.id\n        this.setState({id:_id, type:this.props.type})\n        this.getdata()\n        this.setState({generalwidth:this.myInput.current.offsetWidth})\n    }\n\n    handleClick(_index){\n        console.log(\"test\",_index)\n        this.setState({index:_index, open:true})\n    }\n\n    openLightbox(event, {photo, index}){\n        // console.log(event, photo, index)\n        this.setState({index:index, open:true})\n    }\n\n    closeLightbox(){\n        this.setState({index:0, open:false})\n    }\n\n    render(){\n        var items,i,sf,namefont;\n        items=[];\n        sf = {\n            \"name\":\"Unknown\",\n            \"column\":0,\n        }\n        // console.log(this.state.data)\n        \n        if(this.state.data !== null){\n            \n            for(i=0;i<this.state.data.content.length;i++){\n                // console.log(this.state.data.content[i].id,parseInt(this.state.id,10))\n                if(this.state.data.content[i].id === parseInt(this.state.id,10)){\n                    sf = this.state.data.content[i]\n                    namefont=sf.font.name\n\n                    var columnnum = sf.column\n                    if(columnnum === 0){\n                        columnnum = 1\n                    }\n\n                    var j;\n\n                    var lines = sf.lines;\n\n                    var photos = {}\n\n                    for (j=1; j<=sf.pics.length;j++){\n                        photos[j] = sf.pics[j-1]\n                    }\n\n                    for (j=0; j<lines.length; j++){\n                        //calculate for each line\n                        // console.log(\"line\",j)\n                        var totalwidth=0;\n                        var l;\n                        var index;\n                        var actualhight;\n                        for(l=0; l<lines[j].length; l++){\n                            index = lines[j][l]\n                            totalwidth += 100 * photos[index].ratio\n                        }\n\n                        \n                        if(this.state.generalwidth === null){\n                            actualhight = 100;\n                        }else{\n                            actualhight = (this.state.generalwidth - 100) * 100 / totalwidth;\n                        }\n\n                        // console.log(\"total width:\",totalwidth,\"generalwidth\",this.state.generalwidth,\"actualheight\",actualhight)\n\n                        for(l=0; l<lines[j].length; l++){\n                            index = lines[j][l];\n                            // console.log(\"photo\",index,\"width\",photos[index].ratio * actualhight,\"height\",actualhight)\n                            items.push(\n                                {\n                                    'index':index-1,\n                                    'src':photos[index].src,\n                                    'width':photos[index].ratio * actualhight,\n                                    'height':actualhight\n                                }\n                            )\n                        }\n                    }\n                    \n                    break;\n                }\n            }\n        }else{\n            namefont = \"\"\n        }\n\n        return (\n                <Row style={{minHeight:\"80vh\", justifyContent:\"center\",alignItems:\"center\"}}>\n                    <Col ref={this.myInput} style={{backgroundColor:\"transparent\",marginTop:\"1vh\",borderColor:\"black\", justifyContent:\"center\",alignItems:\"center\"}} xs={10}>\n                    {this.state.open ? (\n                            <div>\n                            <CarouselPage index={this.state.index} interval={null} data={sf} />\n                            <button onClick={this.closeLightbox}>back</button>\n                            </div>\n                            \n                        ) : (\n                            <CardDeck style={{justifyContent:\"center\",alignItems:\"center\"}}>\n                            {items.map(\n                                item => (\n                                    <Img key={item.index} onClick={this.handleClick} index={item.index} src={item.src} style={{backgroundColor:\"transparent\",borderColor:\"transparent\",padding:\"2px 2px 2px 2px\",width:item.width, height:item.height}}/>\n                                )\n                            )}\n                            </CardDeck >\n                        )}\n                    </Col>\n                </Row>\n            \n        )\n        \n        \n    }\n};\n\nexport default Album;"]},"metadata":{},"sourceType":"module"}